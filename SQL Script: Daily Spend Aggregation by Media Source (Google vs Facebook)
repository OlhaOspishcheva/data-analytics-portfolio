-- The aggregated metrics (average, maximum and minimum) for daily spend on Google and Facebook are displayed separately.

WITH main_table AS (
  SELECT 
     ad_date,
     'Facebook' AS media_source,
     spend 
  FROM facebook_ads_basic_daily
     
  UNION ALL
     
  SELECT 
     ad_date,
     'Google' AS media_source,
     spend
  FROM google_ads_basic_daily
)

SELECT 
    ad_date,
    media_source,
    ROUND(AVG(spend), 2) AS avg_spend,
    ROUND(MAX(spend), 2) AS max_spend,
    ROUND(MIN(spend), 2) AS min_spend
FROM main_table
GROUP BY ad_date, media_source
ORDER BY ad_date, media_source;
